{% load static cms_tags %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    {# SEO Meta Tags #}
    <title>{% block title %}{{ page.meta_title|default:page.title|default:site_config.site_name }}{% endblock %}</title>
    <meta name="description" content="{% block meta_description %}{{ page.meta_description|default:site_config.default_meta_description }}{% endblock %}">

    {# Open Graph Meta Tags #}
    <meta property="og:title" content="{% block og_title %}{{ page.meta_title|default:page.title|default:site_config.site_name }}{% endblock %}">
    <meta property="og:description" content="{% block og_description %}{{ page.meta_description|default:site_config.default_meta_description }}{% endblock %}">
    <meta property="og:type" content="website">
    <meta property="og:url" content="{{ request.build_absolute_uri }}">
    {% if page.og_image %}
    <meta property="og:image" content="{{ request.scheme }}://{{ request.get_host }}{{ page.og_image.url }}">
    {% endif %}

    {# Favicon #}
    {% if site_config.favicon %}
    <link rel="icon" type="image/png" href="{{ site_config.favicon.url }}">
    {% endif %}

    {# Bootstrap 5 CSS #}
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    {# Bootstrap Icons #}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

    {# Custom CSS #}
    <link rel="stylesheet" href="{% static 'css/custom.css' %}">

    {# Dynamic Theme Styles #}
    <style>
        :root {
            --primary-color: {{ site_config.primary_color|default:"#007bff" }};
            --secondary-color: {{ site_config.secondary_color|default:"#6c757d" }};
            --text-color: {{ site_config.text_color|default:"#212529" }};
            --background-color: {{ site_config.background_color|default:"#ffffff" }};
            --font-family: {{ site_config.font_family|default:"Arial, sans-serif" }};
            --base-font-size: {{ site_config.base_font_size|default:"16" }}px;
        }

        body {
            font-family: var(--font-family);
            font-size: var(--base-font-size);
            color: var(--text-color);
            background-color: var(--background-color);
        }

        .btn-primary {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
        }

        .btn-primary:hover {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
            opacity: 0.9;
        }

        .text-primary {
            color: var(--primary-color) !important;
        }

        .bg-primary {
            background-color: var(--primary-color) !important;
        }
    </style>

    {% block extra_css %}{% endblock %}

    {# Google Analytics #}
    {% if site_config.google_analytics_id %}
    <script async src="https://www.googletagmanager.com/gtag/js?id={{ site_config.google_analytics_id }}"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', '{{ site_config.google_analytics_id }}');
    </script>
    {% endif %}
</head>
<body>
    {# Navigation #}
    {% include 'cms_app/includes/navigation.html' %}

    {# Main Content #}
    <main>
        {% block content %}{% endblock %}
    </main>

    {# Footer #}
    {% include 'cms_app/includes/footer.html' %}

    {# Bootstrap 5 JS Bundle #}
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    {# Custom JavaScript #}
    <script src="{% static 'js/custom.js' %}"></script>

    {% block extra_js %}{% endblock %}
</body>
</html>
